import { Char } from "../internal-data-formats/char";
import { serializeColorPixelByte } from "../internal-data-formats/color-pixel-byte";
import { ReadonlyTuple } from "../tuple";
import { DataSegment } from "./io";

export const shadowChars = {
	originalC64: [
		[
			[0, 0, 0, 0],
			[1, 1, 1, 1],
			[0, 1, 1, 1],
			[0, 0, 1, 1],
			[0, 0, 0, 0],
			[0, 0, 0, 0],
			[0, 0, 0, 0],
			[0, 0, 0, 0],
		],
		[
			[0, 1, 1, 0],
			[1, 1, 1, 0],
			[1, 1, 1, 0],
			[1, 1, 1, 0],
			[0, 0, 0, 0],
			[0, 0, 0, 0],
			[0, 0, 0, 0],
			[0, 0, 0, 0],
		],
		[
			[0, 1, 0, 0],
			[0, 1, 0, 0],
			[0, 1, 1, 0],
			[0, 1, 1, 0],
			[0, 1, 1, 0],
			[0, 1, 1, 0],
			[0, 1, 1, 0],
			[0, 1, 1, 0],
		],
		[
			[0, 0, 0, 0],
			[1, 1, 1, 1],
			[1, 1, 1, 1],
			[1, 1, 1, 1],
			[0, 0, 0, 0],
			[0, 0, 0, 0],
			[0, 0, 0, 0],
			[0, 0, 0, 0],
		],
		[
			[0, 1, 1, 0],
			[0, 1, 1, 0],
			[0, 1, 1, 0],
			[0, 1, 1, 0],
			[0, 1, 1, 0],
			[0, 1, 1, 0],
			[0, 1, 1, 0],
			[0, 1, 1, 0],
		],
		[
			[0, 0, 0, 0],
			[0, 1, 1, 1],
			[0, 1, 1, 1],
			[0, 1, 1, 1],
			[0, 1, 1, 0],
			[0, 1, 1, 0],
			[0, 1, 1, 0],
			[0, 1, 1, 0],
		],
	],

	retroForge: [
		[
			[1, 0, 1, 0],
			[0, 1, 0, 1],
			[0, 0, 1, 0],
			[0, 0, 0, 1],
			[0, 0, 0, 0],
			[0, 0, 0, 0],
			[0, 0, 0, 0],
			[0, 0, 0, 0],
		],
		[
			[1, 0, 0, 0],
			[0, 1, 0, 0],
			[1, 0, 0, 0],
			[0, 1, 0, 0],
			[0, 0, 0, 0],
			[0, 0, 0, 0],
			[0, 0, 0, 0],
			[0, 0, 0, 0],
		],
		[
			[1, 0, 0, 0],
			[0, 1, 0, 0],
			[1, 0, 0, 0],
			[0, 1, 0, 0],
			[1, 0, 0, 0],
			[0, 1, 0, 0],
			[1, 0, 0, 0],
			[0, 1, 0, 0],
		],
		[
			[1, 0, 1, 0],
			[0, 1, 0, 1],
			[1, 0, 1, 0],
			[0, 1, 0, 1],
			[0, 0, 0, 0],
			[0, 0, 0, 0],
			[0, 0, 0, 0],
			[0, 0, 0, 0],
		],
		[
			[1, 0, 0, 0],
			[0, 1, 0, 0],
			[1, 0, 0, 0],
			[0, 1, 0, 0],
			[1, 0, 0, 0],
			[0, 1, 0, 0],
			[1, 0, 0, 0],
			[0, 1, 0, 0],
		],
		[
			[1, 0, 1, 0],
			[0, 1, 0, 1],
			[1, 0, 1, 0],
			[0, 1, 0, 1],
			[1, 0, 0, 0],
			[0, 1, 0, 0],
			[1, 0, 0, 0],
			[0, 1, 0, 0],
		],
	],
} satisfies Record<string, ReadonlyTuple<Char, 6>>;

export type ShadowStyle = keyof typeof shadowChars;

export function detectShadowStyle(dataSegment: DataSegment): ShadowStyle {
	return dataSegment.buffer[0] ===
		serializeColorPixelByte(shadowChars.originalC64[0][0])
		? "originalC64"
		: "retroForge";
}
